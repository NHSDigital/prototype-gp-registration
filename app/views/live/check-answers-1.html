{% set serviceHome = '/live/start' %}
{% set servicePhase = 'beta' %}
{% set feedbackType = 'step' %}
{% set section = '1' %}

{% extends 'layout.html' %}

{% if (data['who-is-being-registered'] === "dependant") %}
  {% set heading = 'Please confirm these are the correct details for the person registering with ' + data.presets[0].gpsurgery %}
{% else %}
  {% set heading = 'Please confirm these are the correct details for the person registering with ' + data.presets[0].gpsurgery %}
{% endif %}

{% if (data['registering-first-time'] === "No") %}
  {% set link = 'registered-for-the-first-time' %}
{% else %}
  {% set link = 'registered-for-the-first-time' %}
{% endif %}

{% if data['date-of-birth'][1] %}
  {% set month = data['date-of-birth'][1] | returnDate %}
{% endif %}

{% block pageTitle %}
  {{ heading }} - {{ ServiceName }} - NHS
{% endblock %}

{% block outerContent %}
  {{ backLink({
    "href": link,
    "text": "Go back",
    "classes": "nhsuk-u-margin-top-4 nhsuk-u-margin-bottom-0"
  }) }}
{% endblock %}

{% block content %}

      <div class="nhsuk-grid-row">
        <div class="nhsuk-grid-column-two-thirds">

          <form action="do-you-current-address" method="post" autocomplete="off">

            <h1 class="nhsuk-heading-l">{{ heading }}</h1>

            {% if (data['who-is-being-registered'] === "dependant") %}
            <h2 class="nhsuk-heading-m">Your details</h2>

            {{ summaryList({
            rows: [
              {
                key: {
                  text: "Relationship to person being registered"
                },
                value: {
                  text: data['relation']
                },
                actions: {
                  items: [
                    {
                      href: "relation-of-dependant?return=true",
                      text: "Change",
                      visuallyHiddenText: "relationship to person being registered"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "First name"
                },
                value: {
                  text: data['carer-first-name']
                },
                actions: {
                  items: [
                    {
                      href: "carer-details?return=true",
                      text: "Change",
                      visuallyHiddenText: "first name"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Last name"
                },
                value: {
                  text: data['carer-last-name']
                },
                actions: {
                  items: [
                    {
                      href: "carer-details?return=true",
                      text: "Change",
                      visuallyHiddenText: "last name"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Relationship"
                },
                value: {
                  text: data['carer-relationship']
                },
                actions: {
                  items: [
                    {
                      href: "carer-details?return=true",
                      text: "Change",
                      visuallyHiddenText: "relationship"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Contact telephone"
                },
                value: {
                  text: data['carer-telephone']
                },
                actions: {
                  items: [
                    {
                      href: "carer-details?return=true",
                      text: "Change",
                      visuallyHiddenText: "relationship"
                    }
                  ]
                }
              }
            ]
          }) }}



            {% endif %}


            <h2 class="nhsuk-heading-m">
              {% if (data['who-is-being-registered'] === "dependant") %}
              Patient details</p>
              {% else %}
              Your details</p>
              {% endif %}
            </h2>

            {{ summaryList({
            rows: [
              {
                key: {
                  text: "Title"
                },
                value: {
                  text: data['name-title']
                },
                actions: {
                  items: [
                    {
                      href: "what-is-your-name?return=true",
                      text: "Change",
                      visuallyHiddenText: "title"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "First name"
                },
                value: {
                  text: data['name-first-name']
                },
                actions: {
                  items: [
                    {
                      href: "what-is-your-name?return=true",
                      text: "Change",
                      visuallyHiddenText: "first name"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Middle name(s)"
                },
                value: {
                  text: data['name-middle-name']
                },
                actions: {
                  items: [
                    {
                      href: "what-is-your-name?return=true",
                      text: "Change",
                      visuallyHiddenText: "middle names"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Last name"
                },
                value: {
                  text: data['name-last-name']
                },
                actions: {
                  items: [
                    {
                      href: "what-is-your-name?return=true",
                      text: "Change",
                      visuallyHiddenText: "last name"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Previous last name"
                },
                value: {
                  text: data['name-previous-last-name']
                },
                actions: {
                  items: [
                    {
                      href: "what-is-your-name?return=true",
                      text: "Change",
                      visuallyHiddenText: "previous last name"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Do you know their NHS number?"
                },
                value: {
                  text: data['know-nhs-number']
                },
                actions: {
                  items: [
                    {
                      href: "do-you-know-nhs?return=true",
                      text: "Change",
                      visuallyHiddenText: "NHS number"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "What is their NHS number?"
                },
                value: {
                  text: data['nhs-number']
                },
                classes: "nhsuk-u-visually-hidden",
                actions: {
                  items: [
                    {
                      href: "do-you-know-nhs?return=true",
                      text: "Change",
                      visuallyHiddenText: "NHS number"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Date of birth"
                },
                value: {
                  html: data['date-of-birth'][0] + " " + month + " " + data['date-of-birth'][2]
                },
                actions: {
                  items: [
                    {
                      href: "what-is-your-dob?return=true",
                      text: "Change",
                      visuallyHiddenText: "date of birth"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Registering with a UK GP for the first time?"
                },
                value: {
                  text: data['registering-first-time']
                },
                actions: {
                  items: [
                    {
                      href: "do-you-know-previous-postcode-gp-has?return=true",
                      text: "Change",
                      visuallyHiddenText: "date of birth"
                    }
                  ]
                }
              },
              {
                key: {
                  text: "Do they know the postcode they last registered with a UK GP?"
                },
                value: {
                  text: data['gp-postcode-prev']
                },
                actions: {
                  items: [
                    {
                      href: "what-is-previous-postcode-gp-has?return=true",
                      text: "Change",
                      visuallyHiddenText: "date of birth"
                    }
                  ]
                }
              }
            ]
          }) }}

        {% if (data['who-is-being-registered'] == "dependant") %}
        <p>We use this information to match their details to our database. We cannot access their medical record and no medical information will be shared at this stage.</p>
        {% else %}
        <p>We use this information to match your details to our database. We cannot access your medical record and no medical information will be shared at this stage.</p>
        {% endif %}

        {{ button({
          "text": "Confirm and continue"
        }) }}

      </form>
    </div>
  </div>

{% include 'live/includes/devmode.html' %}

{% endblock %}

{% block pageScripts %}

<script>

  $(document).ready(function () {

    // Populate any unanswered fields with "Not answered" text
    $('.nhsuk-summary-list__value').filter(function () {
      return $.trim($(this).text()) === "";
    }).each(function (ind, obj) {
      $(obj).closest('dd').html("<span class='summary-page-unanswered'>Not answered</span>");
    });

    // Add colon to contact method type if it isn't blank
    $(".contact-prefs-type:not(:empty)").append(':');

  });
</script>

{% endblock %}


{% block footer %}
  {% include 'live/includes/footer.html' %}
{% endblock %}
